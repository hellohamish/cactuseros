function mostrarCartel(c,b,a){cont=$(c);cont.stop(true,true);cont.fadeOut("slow",function(){$("#mensaje").remove();cont.append('<div id="mensaje"><h1>'+b+"</h1>"+a+"<br/><br/><br/></div>");cont.fadeIn("normal",function(){hacerScroll(cont)})})}function hacerScroll(a){$("html,body").animate({scrollTop:$(a).offset().top-100},{duration:"slow",easing:"swing"})}function ltrim(a){return a.replace(/^\s+/,"")}function rtrim(a){return a.replace(/\s+$/,"")}function trim(a){return rtrim(ltrim(a))}var contenedorOriginal;var padre;function mostrarModal(a){cerrarModal();inicializarContenidoModal(a);$("#modalAgus").modal()}function mostrarModalSticky(a){cerrarModal();inicializarContenidoModal(a);$("#modalAgus").modal({escapeClose:false,clickClose:false,showClose:false})}function inicializarContenidoModal(a){ancho=$(a).width();largo=$(a).height();padre=$(a).parent();elemento=$(a).detach();elemento.appendTo("#contenidoModal");$("#contenidoModal").width(ancho);$("#contenidoModal").height(largo);$("#modalAgus").css("background-color",$(a).css("background-color"));$(a).fadeIn("slow");contenedorOriginal=a}function guardarModal(){if(contenedorOriginal!=null){$(contenedorOriginal).hide();elemento=$(contenedorOriginal).detach();elemento.appendTo(padre)}}function mostrarEstado(b,a){cerrarModal();$("#modalTexto").html('<div style="display:inline-block;">'+b+"</div>");$("#modalTexto").show();if(a){mostrarModalSticky("#modalTexto")}else{mostrarModal("#modalTexto")}}function mostrarEstadoTimer(c,a,b){mostrarEstado(c,true);setTimeout(function(){cerrarModal();b()},a*1000)}function cerrarModal(){if(contenedorOriginal!=null){guardarModal();$.modal.close();contenedorOriginal=null;padre=null}}function navegar(a){window.location=a}function refrescar(){location.reload()}function pedirLogin(){mostrarModal("#formularioLogin")}function intentarLogin(){mostrarEstado(MSG_INGRESANDO,true);$.post(BASE+"Login",$("#formularioLogin").serialize()).done(function(a){respuesta=a.split("@");a=respuesta[0];if(a=="ok"){usuario=respuesta[1];navegar(BASE)}else{mostrarEstadoTimer(a,3,function(){mostrarModal("#formularioLogin")})}}).fail(function(a){mostrarEstadoTimer(MSG_ERROR_CONEXION,3,function(){mostrarModal("#formularioLogin")})})}function mostrarOpcionRecuperar(){mostrarModal("#recuperarPass")}function recuperar(){var b=$("#email").val();var a=BASE+"recuperarPassword/"+b;$.post(a,{},function(c){mostrarEstadoTimer(MSG_LE_ENVIAMOS_DATOS,3,function(){})})}function crearCuenta(){mostrarModal("#formularioRegistro")}function caracteresValidos(a){var b=/^[A-Za-z0-9]+$/;if(a.val().match(b)){return true}else{return false}}function emailValido(c){var a=c.val();var b=a.indexOf("@");var d=a.lastIndexOf(".");if(b<1||d<b+2||d+2>=a.length){return false}return true}function guardarDatosCuenta(){mostrarEstado(MSG_CREANDO_CTA,true);if(!caracteresValidos($("#nombreNuevoUsuario"))){mostrarEstadoTimer(MSG_USERNAME_ALFANUMERICO,3,function(){mostrarModal("#formularioRegistro")});return}if(!emailValido($("#emailNuevoUsuario"))){mostrarEstadoTimer(MSG_EMAIL_INVALIDO,3,function(){mostrarModal("#formularioRegistro")});return}if($("#Pais option:selected").val()==-444){mostrarEstadoTimer(MSG_SELECT_COUNTRY,3,function(){mostrarModal("#formularioRegistro")});return}$.post(BASE+"PostDatosCuenta",$("#formRegistro").serialize()).done(function(a){respuesta=a.split("@");a=respuesta[0];if(a=="ok"){usuario=respuesta[1];mostrarEstadoTimer(MSG_EMAIL_ACTIVATE,10,function(){pedirLogin()})}else{mostrarEstadoTimer(a,3,function(){mostrarModal("#formularioRegistro")})}}).fail(function(a){mostrarEstadoTimer(MSG_ERROR_CONEXION,3,function(){mostrarModal("#formularioRegistro")})})}function solicitarFicha(){mostrarModal("#formularioSolicitudFicha")}function enviarSolicitud(){mostrarEstado("Recolectando informaci√≥n de la especie...",true);$.post(BASE+"FrontController.php?comando=PedirFicha&opcion=obtenerdeTPL",$("#formularioSolicitudFicha").serialize()).done(function(a){if(a.toLowerCase().indexOf("error")!==-1){mostrarEstadoTimer(a,5,function(){mostrarModal("#formularioSolicitudFicha")})}else{$("#contenedorRespuestasServer").html(a);mostrarModal("#formularioConfirmacionSolicitud")}}).fail(function(a){mostrarEstadoTimer(MSG_ERROR_CONEXION,3,function(){mostrarModal("#formularioSolicitudFicha")})})}function confirmarSolicitud(){mostrarEstado("Enviando el pedido...",true);$.post(BASE+"FrontController.php?comando=PedirFicha&opcion=guardar",$("#formularioConfirmacionSolicitud").serialize()).done(function(a){if(a.toLowerCase().indexOf("error")!==-1){mostrarEstadoTimer(a,5,function(){mostrarModal("#formularioSolicitudFicha")})}else{mostrarEstadoTimer("Su solicitud ha sido registrada!",2,function(){})}}).fail(function(a){mostrarEstadoTimer(MSG_ERROR_CONEXION,3,function(){mostrarModal("#formularioSolicitudFicha")})})}function setActivo(a,b){e=$("#"+a);if(e!=null){e.attr("disabled",b)}}$(document).ready(function(){cargarSugerenciasHechas();setActivo("BotonSugerirEspecieLista",true);$("#formSugerenciaEspecieExistente").ajaxForm({beforeSubmit:function(){window.location=BASE+"Login";return;$("#formSugerenciaEspecieExistente").slideUp("slow",function(){mostrarCartel("#wrapperFormSugerenciaEspecieExistente","Sugiriendo Especie","Por favor espere...")});return true},success:function(){$("#formSugerenciaEspecieExistente").remove();$("#wrapperFormSugerenciaEspecieExistente").fadeOut("normal",function(){hacerScroll("#SectorSugerencias");cargarSugerenciasHechas();$("#SectorOpcionesSugerencia").remove();window.location=BASE+"Detalles/SinIdentificar/{IdClasificacion}/VerCactus.html"})}})});function cargarSugerenciasHechas(){cargar("SectorSugerencias","wrapperSectorSugerencias",BASE_LANG+"/SectorSugerencias/"+ID_CLASIFICACION)}function cargar(b,c,a){$("#"+b).hide("fast",cargarContenido(b,a));$("#cargando"+b).remove();$("#"+c).append('<center><span id="cargando'+b+'"><br><br>Cargando...<br/><img src="'+BASE+'Imagenes/cargando.gif"><br><br></span></center>');$("#cargando"+b).fadeIn("normal")}function cargarContenido(b,a){$("#"+b).load(a,"",function(){$("#"+b).fadeIn("normal",function(){$("#cargando"+b).fadeOut("normal")})})};